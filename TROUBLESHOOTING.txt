========================================
راهنمای عیب‌یابی
Android to Windows Streaming
========================================

این سند شامل راه‌حل‌های مشکلات رایج است.

========================================
مشکلات اپلیکیشن اندروید
========================================

مشکل 1: اپلیکیشن باز نمی‌شود
----------------------------------------
علل ممکن:
- نسخه اندروید کمتر از 8.0
- فضای ذخیره‌سازی کافی نیست

راه‌حل:
- بررسی نسخه اندروید (تنظیمات > درباره تلفن)
- حداقل 100 MB فضای خالی داشته باشید
- اپلیکیشن را حذف و دوباره نصب کنید

مشکل 2: دوربین کار نمی‌کند
----------------------------------------
علل ممکن:
- دسترسی به دوربین داده نشده
- دوربین توسط برنامه دیگری استفاده می‌شود

راه‌حل:
- تنظیمات > برنامه‌ها > Android Stream > مجوزها
- دسترسی به دوربین و میکروفون را فعال کنید
- دستگاه را restart کنید
- اطمینان حاصل کنید که برنامه دیگری دوربین را باز نکرده

مشکل 3: استریم قطع می‌شود
----------------------------------------
علل ممکن:
- باتری کم
- حالت صرفه‌جویی انرژی فعال است
- اپلیکیشن در پس‌زمینه kill می‌شود

راه‌حل:
- دستگاه را به برق وصل کنید
- حالت صرفه‌جویی انرژی را خاموش کنید
- از Battery Optimization برای این اپ استثنا قرار دهید
- تنظیمات > باتری > بهینه‌سازی باتری > Android Stream > اجازه ندهید

========================================
مشکلات اتصال WiFi
========================================

مشکل 1: نمی‌تواند به گوشی متصل شود
----------------------------------------
علل ممکن:
- دستگاه‌ها در شبکه مختلف هستند
- آدرس IP اشتباه است
- فایروال مسدود کرده

راه‌حل:
- مطمئن شوید هر دو به یک WiFi متصل هستند
- آدرس IP را از اپ اندروید بردارید
- فایروال ویندوز را چک کنید:
  * Control Panel > Windows Defender Firewall
  * Allow an app through firewall
  * Python را اضافه کنید
- پورت 8888 باز باشد

مشکل 2: اتصال برقرار می‌شود اما قطع می‌شود
----------------------------------------
علل ممکن:
- سیگنال WiFi ضعیف
- پهنای باند کافی نیست
- تداخل شبکه

راه‌حل:
- به روتر نزدیک‌تر شوید
- از شبکه 5GHz استفاده کنید (سریع‌تر)
- سایر دستگاه‌ها را از شبکه disconnect کنید
- رزولوشن و FPS را کاهش دهید
- به جای WiFi از USB استفاده کنید

========================================
مشکلات اتصال USB
========================================

مشکل 1: ADB پیدا نمی‌شود
----------------------------------------
راه‌حل:
- Android SDK Platform Tools را دانلود کنید:
  https://developer.android.com/studio/releases/platform-tools
- فایل‌ها را در یک پوشه استخراج کنید (مثلاً C:\adb)
- مسیر را به PATH اضافه کنید:
  * کلیک راست روی This PC > Properties
  * Advanced system settings > Environment Variables
  * در System Variables، Path را انتخاب کنید
  * Edit > New > C:\adb (یا مسیر شما)
- CMD را restart کنید و تست کنید: adb version

مشکل 2: دستگاه شناسایی نمی‌شود
----------------------------------------
راه‌حل:
- USB Debugging را در گوشی فعال کنید:
  * تنظیمات > درباره تلفن
  * 7 بار روی Build Number بزنید
  * تنظیمات > Developer options > USB debugging
- کابل USB را تعویض کنید (برخی فقط شارژ می‌کنند)
- درایورهای USB گوشی را نصب کنید
- در CMD تست کنید: adb devices
- اگر "unauthorized" نشان داد، در گوشی Allow را بزنید

مشکل 3: اتصال USB بسیار کند است
----------------------------------------
راه‌حل:
- از کابل USB 3.0 استفاده کنید
- مستقیماً به پورت USB کامپیوتر وصل کنید (نه hub)
- USB debugging mode را چک کنید
- از port دیگری استفاده کنید

========================================
مشکلات Virtual Camera
========================================

مشکل 1: Virtual Camera در لیست نیست
----------------------------------------
راه‌حل:
- مطمئن شوید register.bat به عنوان Admin اجرا شده
- ویندوز را restart کنید
- Device Manager را چک کنید:
  * Win+X > Device Manager
  * Sound, video and game controllers
  * باید "Android Virtual Camera" را ببینید
- اگر نبود، دوباره build و register کنید

مشکل 2: Virtual Camera در برنامه‌ها کار نمی‌کند
----------------------------------------
راه‌حل:
- برنامه را restart کنید
- مطمئن شوید که استریم در حال اجراست
- در Windows App، Virtual Camera را فعال کنید
- برخی برنامه‌ها نیاز به restart دارند
- Antivirus را موقتاً غیرفعال کنید

مشکل 3: تصویر سیاه یا freeze است
----------------------------------------
راه‌حل:
- مطمئن شوید استریم متصل است
- در Windows App بررسی کنید که ویدیو نمایش داده می‌شود
- Virtual Camera را غیرفعال و دوباره فعال کنید
- اپلیکیشن Windows را restart کنید

========================================
مشکلات کیفیت تصویر
========================================

مشکل 1: تصویر کیفیت پایین دارد
----------------------------------------
راه‌حل:
- رزولوشن را افزایش دهید (720p یا 1080p)
- Bitrate را در VideoEncoder.kt افزایش دهید
- از USB به جای WiFi استفاده کنید
- نور محیط را بهبود بخشید

مشکل 2: تصویر lag دارد یا freeze می‌شود
----------------------------------------
راه‌حل:
- رزولوشن را کاهش دهید (480p)
- FPS را کم کنید (15 یا 30)
- از USB استفاده کنید
- سایر برنامه‌های استفاده از شبکه را ببندید
- CPU و RAM گوشی را چک کنید

مشکل 3: رنگ‌ها اشتباه است
----------------------------------------
راه‌حل:
- این ممکن است به خاطر تبدیل color space باشد
- در Virtual Camera از RGB24 استفاده می‌شود
- برخی برنامه‌ها ممکن است format دیگری بخواهند

========================================
مشکلات صدا
========================================

مشکل 1: صدا پخش نمی‌شود
----------------------------------------
راه‌حل:
- دسترسی میکروفون را در اندروید چک کنید
- Volume ویندوز را بالا ببرید
- در Sound Settings بررسی کنید که output صحیح است
- PyAudio را دوباره نصب کنید: pip install --upgrade pyaudio

مشکل 2: صدا delay دارد
----------------------------------------
راه‌حل:
- این طبیعی است (معمولاً 100-300ms)
- برای کاهش از USB استفاده کنید
- FPS و resolution را کاهش دهید
- Buffer size را در AudioDecoder.py کم کنید

مشکل 3: صدا قطع-قطع است
----------------------------------------
راه‌حل:
- پهنای باند شبکه را چک کنید
- Sample rate و bitrate را در AudioEncoder.kt کاهش دهید
- از اتصال USB استفاده کنید

========================================
مشکلات عملکرد
========================================

مشکل 1: گوشی خیلی داغ می‌شود
----------------------------------------
راه‌حل:
- رزولوشن و FPS را کاهش دهید
- دستگاه را در محیط خنک‌تر قرار دهید
- Hardware encoding را چک کنید
- استریم‌های طولانی را محدود کنید

مشکل 2: باتری سریع تمام می‌شود
----------------------------------------
راه‌حل:
- دستگاه را به برق وصل کنید
- رزولوشن را به 480p کاهش دهید
- FPS را به 15 کاهش دهید
- صفحه گوشی را خاموش کنید (اپ در background کار می‌کند)

مشکل 3: CPU Usage بالا در ویندوز
----------------------------------------
راه‌حل:
- از Hardware decoding استفاده کنید
- رزولوشن را کاهش دهید
- Quality settings را پایین بیاورید

========================================
مشکلات Build
========================================

مشکل 1: Android Studio build نمی‌شود
----------------------------------------
راه‌حل:
- Gradle sync را اجرا کنید
- JDK 17 نصب باشد
- Android SDK را آپدیت کنید
- Invalidate Caches and Restart

مشکل 2: Python dependencies نصب نمی‌شوند
----------------------------------------
راه‌حل:
- Python 3.11+ نصب باشد
- pip را آپدیت کنید: python -m pip install --upgrade pip
- Microsoft Visual C++ 14.0 or greater نیاز است:
  https://visualstudio.microsoft.com/downloads/
- PyAudio مشکل دارد؟ wheel از اینجا دانلود کنید:
  https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyaudio

مشکل 3: Virtual Camera build نمی‌شود
----------------------------------------
راه‌حل:
- Visual Studio 2022 با C++ workload نصب باشد
- Windows SDK نصب باشد
- DirectShow Base Classes را دانلود کنید
- CMake نصب باشد
- به عنوان Administrator اجرا کنید

========================================
دیگر مشکلات
========================================

مشکل: همه چیز کار می‌کند اما latency زیاد است
----------------------------------------
راه‌حل:
- از USB به جای WiFi استفاده کنید
- رزولوشن و FPS را کاهش دهید
- Buffer size را کم کنید
- از شبکه 5GHz WiFi استفاده کنید
- نزدیک روتر باشید

مشکل: پیام "Permission Denied"
----------------------------------------
راه‌حل:
- در اندروید: همه دسترسی‌ها را بدهید
- در ویندوز: به عنوان Administrator اجرا کنید
- Antivirus را چک کنید

========================================
دریافت کمک بیشتر
========================================

اگر مشکل شما حل نشد:
1. Log files را چک کنید
2. مشخصات دستگاه و سیستم عامل را یادداشت کنید
3. Screenshot از error بگیرید
4. در GitHub Issue ایجاد کنید

========================================

